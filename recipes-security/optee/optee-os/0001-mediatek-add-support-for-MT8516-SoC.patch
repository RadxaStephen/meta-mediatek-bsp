From 6dee9143bb6c734c257b23bc673a39a2e4fe1f36 Mon Sep 17 00:00:00 2001
From: Fabien Parent <fparent@baylibre.com>
Date: Sun, 24 Feb 2019 19:41:08 +0100
Subject: [PATCH] mediatek: add support for MT8516 SoC

Signed-off-by: Fabien Parent <fparent@baylibre.com>
---
 core/arch/arm/plat-mediatek/conf.mk           | 14 ++++++++++----
 core/arch/arm/plat-mediatek/platform_config.h | 14 ++++++++++++++
 2 files changed, 24 insertions(+), 4 deletions(-)

diff --git a/core/arch/arm/plat-mediatek/conf.mk b/core/arch/arm/plat-mediatek/conf.mk
index 3bae090b..09c7ad07 100644
--- a/core/arch/arm/plat-mediatek/conf.mk
+++ b/core/arch/arm/plat-mediatek/conf.mk
@@ -3,10 +3,6 @@ PLATFORM_FLAVOR ?= mt8173
 include core/arch/arm/cpu/cortex-armv8-0.mk
 
 $(call force,CFG_TEE_CORE_NB_CORE,4)
-CFG_TZDRAM_START ?= 0xbe000000
-CFG_TZDRAM_SIZE ?= 0x01e00000
-CFG_SHMEM_START ?= 0xbfe00000
-CFG_SHMEM_SIZE ?= 0x00200000
 
 $(call force,CFG_8250_UART,y)
 $(call force,CFG_GENERIC_BOOT,y)
@@ -28,4 +24,14 @@ CFG_WITH_STACK_CANARIES ?= y
 ifeq ($(PLATFORM_FLAVOR),mt8173)
 # 2**1 = 2 cores per cluster
 $(call force,CFG_CORE_CLUSTER_SHIFT,1)
+CFG_TZDRAM_START ?= 0xbe000000
+CFG_TZDRAM_SIZE ?= 0x01e00000
+CFG_SHMEM_START ?= 0xbfe00000
+CFG_SHMEM_SIZE ?= 0x00200000
+else ($(PLATFORM_FLAVOR),mt8516)
+$(call force,CFG_CORE_CLUSTER_SHIFT,2)
+CFG_TZDRAM_START ?= 0x4fd00000
+CFG_TZDRAM_SIZE ?=  0x00300000
+CFG_SHMEM_START ?= 0x5fd00000
+CFG_SHMEM_SIZE ?= 0x00200000
 endif
diff --git a/core/arch/arm/plat-mediatek/platform_config.h b/core/arch/arm/plat-mediatek/platform_config.h
index bf5b0bdc..b8525b21 100644
--- a/core/arch/arm/plat-mediatek/platform_config.h
+++ b/core/arch/arm/plat-mediatek/platform_config.h
@@ -35,6 +35,20 @@
 #define DRAM0_BASE		0x40000000
 #define DRAM0_SIZE		0x80000000
 
+#elif defined(PLATFORM_FLAVOR_mt8516)
+
+#define GIC_BASE		0x10310000
+#define GICC_OFFSET		0x10000
+#define GICD_OFFSET		0x00000
+
+#define UART0_BASE		0x11005000
+#define UART1_BASE		0x11106000
+#define UART2_BASE		0x11107000
+
+#define CONSOLE_UART_BASE	UART0_BASE
+#define CONSOLE_BAUDRATE	921600
+#define CONSOLE_UART_CLK_IN_HZ	26000000
+
 #else
 #error "Unknown platform flavor"
 #endif
